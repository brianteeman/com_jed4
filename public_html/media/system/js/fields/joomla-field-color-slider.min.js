function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],r=!0,s=!1,i=void 0;try{for(var n,l=t[Symbol.iterator]();!(r=(n=l.next()).done)&&(a.push(n.value),!e||a.length!==e);r=!0);}catch(t){s=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(s)throw i}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}!function(t){"use strict";var e=new RegExp(/^#([a-z0-9]{1,2})([a-z0-9]{1,2})([a-z0-9]{1,2})$/i),a=new RegExp(/^rgba?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)(?:[\D]+([0-9](?:.\d+)?))?\)$/i),r=new RegExp(/^hsla?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)[\D]+([0-9](?:.\d+)?)?\)$/i),s=new RegExp(/^(([0-1])|(0\\.[0-9]+)|([0-9]{1,2})|(100))$/),i=new RegExp(/^[0-9]{1,3}$/),n=function(){function t(e){var a=this;_classCallCheck(this,t),this.messageSpan=e.querySelector(".form-control-feedback"),this.mainInput=e.querySelector(".color-input"),this.input=e.querySelector("#slider-input"),this.sliders=e.querySelectorAll(".color-slider"),this.hueSlider=e.querySelector("#hue-slider"),this.saturationSlider=e.querySelector("#saturation-slider"),this.lightSlider=e.querySelector("#light-slider"),this.alphaSlider=e.querySelector("#alpha-slider"),this.color=e.dataset.color||"",this.default=e.dataset.default||"",this.format=this.input.dataset.format||"hex",this.saveFormat=this.mainInput.dataset.format||"hex",this.preview="true"===e.dataset.preview,this.setAlpha="hsla"===this.format||"rgba"===this.format,this.hue=360,this.saturation=1,this.light=1,this.alpha=1,this.defaultHsl=[this.hue,this.saturation,this.light,this.alpha],this.setInitValue(),this.setBackground(),this.preview?this.setInputPattern():this.input.classList.add("hidden"),this.mainInput.classList.add("hidden"),Array.prototype.forEach.call(this.sliders,(function(t){t.addEventListener("change",(function(){return a.updateValue(t)}))})),this.input.addEventListener("change",(function(){return a.changeInput(a.input)}))}return _createClass(t,[{key:"updateValue",value:function(t){this.showError("");var e=this.getSliderValueAsHsl(t.value,t.dataset.type),a=this.hslToRgb(e),r=_slicedToArray(e,4);this.hue=r[0],this.saturation=r[1],this.light=r[2],this.alpha=r[3],this.input.style.border="2px solid ".concat(this.getRgbString(a)),this.setSliderValues(e,t.dataset.type),this.setInputValue(e),this.setBackground(t)}},{key:"changeInput",value:function(t){var e=[this.hue,this.saturation,this.light,this.alpha];if(!t.value)return this.mainInput.value="",void this.showError("");if(this.checkValue(t.value)){switch(this.showError(""),this.format){case"hue":e[0]=t.value,this.hue=t.value;break;case"saturation":e[1]=t.value,this.saturation=t.value;break;case"light":e[2]=t.value,this.light=t.value;break;case"alpha":e[3]=t.value,this.alpha=t.value;break;default:e=this.getHsl(t.value)}this.setSliderValues(e),this.setInputValue(e,!0)}else this.showError("JFIELD_COLOR_ERROR_WRONG_FORMAT"),this.setInputValue(this.defaultHsl)}},{key:"checkValue",value:function(t,n){switch(n||this.format){case"hue":return t<=360&&i.test(t);case"saturation":case"light":case"alpha":return s.test(t);case"hsl":case"hsla":return r.test(t);case"hex":return e.test(t);case"rgb":case"rgba":return a.test(t);default:return!1}}},{key:"setInputPattern",value:function(){var t;switch(this.format){case"hue":t=i.source.slice(1,-1);break;case"saturation":case"light":case"alpha":t=s.source.slice(1,-1);break;case"hsl":case"hsla":t=r.source.slice(1,-1);break;case"rgb":t=a.source.slice(1,-1);break;case"hex":default:t=e.source.slice(1,-1)}this.input.setAttribute("pattern",t)}},{key:"setBackground",value:function(t){var e=this;Array.prototype.forEach.call(this.sliders,(function(a){if(t!==a){var r=[],s=100;if(r.push(e.getSliderValueAsRgb(0,a.dataset.type)),"hue"===a.dataset.type){var i=Math.floor(18);s=360;for(var n=0;n<=360;n+=i)r.push(e.getSliderValueAsRgb(n,a.dataset.type))}else for(var l=0;l<=100;l+=10)r.push(e.getSliderValueAsRgb(l,a.dataset.type));r.push(e.getSliderValueAsRgb(s,a.dataset.type)),r=r.map((function(t){return e.getRgbString(t)})),a.style.background="linear-gradient(90deg, ".concat(r.join(","),")"),a.style.webkitAppearance="none"}}))}},{key:"setInitValue",value:function(){var t=window.getComputedStyle(this.input).getPropertyValue(this.default);if(this.default=t||this.default,""===this.color||void 0===this.color)return this.input.value="",void(this.mainInput.value="");var e=this.checkValue(this.color,this.saveFormat)?this.color:this.default;if(e){var a=[];/^[0-9]+$/.test(e)?(a=this.default&&this.getHsl(this.default),"hue"===this.format&&(a[0]=e),"saturation"===this.format&&(a[1]=e>1?e/100:e),"light"===this.format&&(a[2]=e>1?e/100:e),"alpha"===this.format&&(a[3]=e>1?e/100:e)):a=this.getHsl(e);var r=_slicedToArray(a,3);this.hue=r[0],this.saturation=r[1],this.light=r[2],this.alpha=a[4]||this.alpha,this.defaultHsl=this.default?this.getHsl(this.default):a,this.setSliderValues(a),this.setInputValue(a),this.input.style.border="2px solid ".concat(this.getRgbString(this.hslToRgb(a)))}else this.showError("JFIELD_COLOR_ERROR_NO_COLOUR")}},{key:"showError",value:function(t){this.messageSpan.innerText=t?Joomla.Text._(t):""}},{key:"getHsl",value:function(t){var s,i=[];if(Array.isArray(t))i=t;else if(e.test(t))i=this.hexToHsl(t);else if(a.test(t))i=this.rgbToHsl(t);else{if(!r.test(t))return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.defaultHsl;var n=t.match(r);i=[n[1],n[2],n[3],n[4]]}for(s=1;s<i.length;s+=1)i[s]=i[s]>1?i[s]/100:i[s];return i}},{key:"getSliderValueAsHsl",value:function(t,e){var a=this.hue,r=this.saturation,s=this.light,i=this.alpha;switch(e){case"alpha":i=t;break;case"saturation":r=t;break;case"light":s=t;break;case"hue":default:a=t}return s>1&&(s/=100),r>1&&(r/=100),i>1&&(i/=100),[a,r,s,i]}},{key:"getSliderValueAsRgb",value:function(t,e){return this.hslToRgb(this.getSliderValueAsHsl(t,e))}},{key:"setSliderValues",value:function(t,e){var a=_slicedToArray(t,4),r=a[0],s=a[1],i=a[2],n=a[3];this.hueSlider&&"hue"!==e&&(this.hueSlider.value=Math.round(r)),this.saturationSlider&&"saturation"!==e&&(this.saturationSlider.value=Math.round(100*s)),this.lightSlider&&"light"!==e&&(this.lightSlider.value=Math.round(100*i)),n&&this.alphaSlider&&"alpha"!==e&&(this.alphaSlider.value=Math.round(100*n))}},{key:"setInputValue",value:function(t,e){var a=this,r=[this.mainInput];e||r.push(this.input),r.forEach((function(e){var r;switch(e.dataset.format){case"hsl":r=a.getHslString(t);break;case"hsla":r=a.getHslString(t,!0);break;case"rgb":r=a.getRgbString(a.hslToRgb(t));break;case"rgba":r=a.getRgbString(a.hslToRgb(t),!0);break;case"hex":r=a.rgbToHex(a.hslToRgb(t));break;case"alpha":r=Math.round(100*t[3]);break;case"saturation":r=Math.round(100*t[1]);break;case"light":r=Math.round(100*t[2]);break;case"hue":default:r=Math.round(t[0])}e.value=r}))}},{key:"getRgbString",value:function(t,e){var a=_slicedToArray(t,4),r=a[0],s=a[1],i=a[2],n=a[3];if(e||this.setAlpha){var l=void 0===n?this.alpha:n;return"rgba(".concat(r,", ").concat(s,", ").concat(i,", ").concat(l,")")}return"rgb(".concat(r,", ").concat(s,", ").concat(i,")")}},{key:"getHslString",value:function(t,e){var a=_slicedToArray(t,4),r=a[0],s=a[1],i=a[2],n=a[3],l=_slicedToArray([r,s*=100,i*=100].map((function(t){return Math.round(t)})),3);return r=l[0],s=l[1],i=l[2],e||this.setAlpha?(n=n||this.alpha,"hsla(".concat(r,", ").concat(s,"%, ").concat(i,"%, ").concat(n,")")):"hsl(".concat(r,", ").concat(s,"%, ").concat(i,"%)")}},{key:"rgbToHex",value:function(t){var e=t[0].toString(16).toUpperCase(),a=t[1].toString(16).toUpperCase(),r=t[2].toString(16).toUpperCase();return e=1===e.length?"".concat(e).concat(e):e,a=1===a.length?"".concat(a).concat(a):a,r=1===r.length?"".concat(r).concat(r):r,"#".concat(e).concat(a).concat(r)}},{key:"rgbToHsl",value:function(t){var e=t;if("string"==typeof t){var r=t.match(a);e=[r[1],r[2],r[3],r[4]]}var s=_slicedToArray(e.map((function(t){return t>1?t/255:t})),3),i=s[0],n=s[1],l=s[2],h=Math.max(i,n,l),o=Math.min(i,n,l),u=(h+o)/2,c=h-o,d=0,f=0,p=e[3]||t[3]||this.alpha;if(h!==o)switch(f=0===h?h:1===o?o:(h-u)/Math.min(u,1-u),h){case i:d=60*(n-l)/c;break;case n:d=60*(2+(l-i)/c);break;case l:default:d=60*(4+(i-n)/c)}return[d=d<0?d+360:d,f,u,p=p>1?p/100:p]}},{key:"hexToHsl",value:function(t){var a=t.match(e),r=a[1],s=a[2],i=a[3],n=[parseInt(r,16),parseInt(s,16),parseInt(i,16)];return this.rgbToHsl(n)}},{key:"hslToRgb",value:function(t){var e=_slicedToArray(t,4),a=e[0],r=e[1],s=e[2],i=e[3],n=1,l=1,h=1,o=r>1?r/100:r,u=s>1?s/100:s,c=i>1?i/100:i;if(a<0||a>360||o<0||o>1||u<0||u>1)return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.hslToRgb(this.defaultHsl);var d=(1-Math.abs(2*u-1))*o,f=a/60,p=d*(1-Math.abs(f%2-1)),g=u-d/2;if(a>=0&&a<60)n=d,l=p,h=0;else if(a>=60&&a<120)n=p,l=d,h=0;else if(a>=120&&a<180)n=0,l=d,h=p;else if(a>=180&&a<240)n=0,l=p,h=d;else if(a>=240&&a<300)n=p,l=0,h=d;else{if(!(a>=300&&a<=360))return this.showError("JFIELD_COLOR_ERROR_CONVERT_HUE"),this.hslToRgb(this.defaultHsl);n=d,l=0,h=p}var v=[n,l,h].map((function(t){return Math.round(255*(t+g))}));return v.push(c),v}}]),t}();t.addEventListener("DOMContentLoaded",(function(){var e=t.querySelectorAll(".color-slider-wrapper");e&&Array.prototype.forEach.call(e,(function(t){new n(t)}))}))}(document);