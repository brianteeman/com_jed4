import{_ as _objectSpread2}from"./carousel.js";import{B as BaseComponent,S as SelectorEngine,E as EventHandler,a as getTransitionDurationFromElement,e as emulateTransitionEnd,b as typeCheckConfig,r as reflow,c as isRTL,M as Manipulator,D as Data,g as getElementFromSelector,i as isVisible,d as defineJQueryPlugin}from"./dom.min.js?1614481245";var NAME="modal",DATA_KEY="bs.modal",EVENT_KEY=".".concat(DATA_KEY),DATA_API_KEY=".data-api",ESCAPE_KEY="Escape",Default={backdrop:!0,keyboard:!0,focus:!0},DefaultType={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},EVENT_HIDE="hide".concat(EVENT_KEY),EVENT_HIDE_PREVENTED="hidePrevented".concat(EVENT_KEY),EVENT_HIDDEN="hidden".concat(EVENT_KEY),EVENT_SHOW="show".concat(EVENT_KEY),EVENT_SHOWN="shown".concat(EVENT_KEY),EVENT_FOCUSIN="focusin".concat(EVENT_KEY),EVENT_RESIZE="resize".concat(EVENT_KEY),EVENT_CLICK_DISMISS="click.dismiss".concat(EVENT_KEY),EVENT_KEYDOWN_DISMISS="keydown.dismiss".concat(EVENT_KEY),EVENT_MOUSEUP_DISMISS="mouseup.dismiss".concat(EVENT_KEY),EVENT_MOUSEDOWN_DISMISS="mousedown.dismiss".concat(EVENT_KEY),EVENT_CLICK_DATA_API="click".concat(EVENT_KEY).concat(DATA_API_KEY),CLASS_NAME_SCROLLBAR_MEASURER="modal-scrollbar-measure",CLASS_NAME_BACKDROP="modal-backdrop",CLASS_NAME_OPEN="modal-open",CLASS_NAME_FADE="fade",CLASS_NAME_SHOW="show",CLASS_NAME_STATIC="modal-static",SELECTOR_DIALOG=".modal-dialog",SELECTOR_MODAL_BODY=".modal-body",SELECTOR_DATA_TOGGLE='[data-bs-toggle="modal"]',SELECTOR_DATA_DISMISS='[data-bs-dismiss="modal"]',SELECTOR_FIXED_CONTENT=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",SELECTOR_STICKY_CONTENT=".sticky-top";class Modal extends BaseComponent{constructor(e,t){super(e),this._config=this._getConfig(t),this._dialog=SelectorEngine.findOne(SELECTOR_DIALOG,e),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}static get Default(){return Default}static get DATA_KEY(){return DATA_KEY}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(!this._isShown&&!this._isTransitioning){this._element.classList.contains(CLASS_NAME_FADE)&&(this._isTransitioning=!0);var t=EventHandler.trigger(this._element,EVENT_SHOW,{relatedTarget:e});this._isShown||t.defaultPrevented||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),EventHandler.on(this._element,EVENT_CLICK_DISMISS,SELECTOR_DATA_DISMISS,(e=>this.hide(e))),EventHandler.on(this._dialog,EVENT_MOUSEDOWN_DISMISS,(()=>{EventHandler.one(this._element,EVENT_MOUSEUP_DISMISS,(e=>{e.target===this._element&&(this._ignoreBackdropClick=!0)}))})),this._showBackdrop((()=>this._showElement(e))))}}hide(e){if((e&&e.preventDefault(),this._isShown&&!this._isTransitioning)&&!EventHandler.trigger(this._element,EVENT_HIDE).defaultPrevented){this._isShown=!1;var t=this._element.classList.contains(CLASS_NAME_FADE);if(t&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),EventHandler.off(document,EVENT_FOCUSIN),this._element.classList.remove(CLASS_NAME_SHOW),EventHandler.off(this._element,EVENT_CLICK_DISMISS),EventHandler.off(this._dialog,EVENT_MOUSEDOWN_DISMISS),t){var i=getTransitionDurationFromElement(this._element);EventHandler.one(this._element,"transitionend",(e=>this._hideModal(e))),emulateTransitionEnd(this._element,i)}else this._hideModal()}}dispose(){[window,this._element,this._dialog].forEach((e=>EventHandler.off(e,EVENT_KEY))),super.dispose(),EventHandler.off(document,EVENT_FOCUSIN),this._config=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null}handleUpdate(){this._adjustDialog()}_getConfig(e){return e=_objectSpread2(_objectSpread2({},Default),e),typeCheckConfig(NAME,e,DefaultType),e}_showElement(e){var t=this._element.classList.contains(CLASS_NAME_FADE),i=SelectorEngine.findOne(SELECTOR_MODAL_BODY,this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,i&&(i.scrollTop=0),t&&reflow(this._element),this._element.classList.add(CLASS_NAME_SHOW),this._config.focus&&this._enforceFocus();var o=()=>{this._config.focus&&this._element.focus(),this._isTransitioning=!1,EventHandler.trigger(this._element,EVENT_SHOWN,{relatedTarget:e})};if(t){var n=getTransitionDurationFromElement(this._dialog);EventHandler.one(this._dialog,"transitionend",o),emulateTransitionEnd(this._dialog,n)}else o()}_enforceFocus(){EventHandler.off(document,EVENT_FOCUSIN),EventHandler.on(document,EVENT_FOCUSIN,(e=>{document===e.target||this._element===e.target||this._element.contains(e.target)||this._element.focus()}))}_setEscapeEvent(){this._isShown?EventHandler.on(this._element,EVENT_KEYDOWN_DISMISS,(e=>{this._config.keyboard&&e.key===ESCAPE_KEY?(e.preventDefault(),this.hide()):this._config.keyboard||e.key!==ESCAPE_KEY||this._triggerBackdropTransition()})):EventHandler.off(this._element,EVENT_KEYDOWN_DISMISS)}_setResizeEvent(){this._isShown?EventHandler.on(window,EVENT_RESIZE,(()=>this._adjustDialog())):EventHandler.off(window,EVENT_RESIZE)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop((()=>{document.body.classList.remove(CLASS_NAME_OPEN),this._resetAdjustments(),this._resetScrollbar(),EventHandler.trigger(this._element,EVENT_HIDDEN)}))}_removeBackdrop(){this._backdrop.parentNode.removeChild(this._backdrop),this._backdrop=null}_showBackdrop(e){var t=this._element.classList.contains(CLASS_NAME_FADE)?CLASS_NAME_FADE:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className=CLASS_NAME_BACKDROP,t&&this._backdrop.classList.add(t),document.body.appendChild(this._backdrop),EventHandler.on(this._element,EVENT_CLICK_DISMISS,(e=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"===this._config.backdrop?this._triggerBackdropTransition():this.hide())})),t&&reflow(this._backdrop),this._backdrop.classList.add(CLASS_NAME_SHOW),!t)return void e();var i=getTransitionDurationFromElement(this._backdrop);EventHandler.one(this._backdrop,"transitionend",e),emulateTransitionEnd(this._backdrop,i)}else if(!this._isShown&&this._backdrop){this._backdrop.classList.remove(CLASS_NAME_SHOW);var o=()=>{this._removeBackdrop(),e()};if(this._element.classList.contains(CLASS_NAME_FADE)){var n=getTransitionDurationFromElement(this._backdrop);EventHandler.one(this._backdrop,"transitionend",o),emulateTransitionEnd(this._backdrop,n)}else o()}else e()}_triggerBackdropTransition(){if(!EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED).defaultPrevented){var e=this._element.scrollHeight>document.documentElement.clientHeight;e||(this._element.style.overflowY="hidden"),this._element.classList.add(CLASS_NAME_STATIC);var t=getTransitionDurationFromElement(this._dialog);EventHandler.off(this._element,"transitionend"),EventHandler.one(this._element,"transitionend",(()=>{this._element.classList.remove(CLASS_NAME_STATIC),e||(EventHandler.one(this._element,"transitionend",(()=>{this._element.style.overflowY=""})),emulateTransitionEnd(this._element,t))})),emulateTransitionEnd(this._element,t),this._element.focus()}}_adjustDialog(){var e=this._element.scrollHeight>document.documentElement.clientHeight;(!this._isBodyOverflowing&&e&&!isRTL||this._isBodyOverflowing&&!e&&isRTL)&&(this._element.style.paddingLeft="".concat(this._scrollbarWidth,"px")),(this._isBodyOverflowing&&!e&&!isRTL||!this._isBodyOverflowing&&e&&isRTL)&&(this._element.style.paddingRight="".concat(this._scrollbarWidth,"px"))}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}_checkScrollbar(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(e.left+e.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()}_setScrollbar(){this._isBodyOverflowing&&(this._setElementAttributes(SELECTOR_FIXED_CONTENT,"paddingRight",(e=>e+this._scrollbarWidth)),this._setElementAttributes(SELECTOR_STICKY_CONTENT,"marginRight",(e=>e-this._scrollbarWidth)),this._setElementAttributes("body","paddingRight",(e=>e+this._scrollbarWidth))),document.body.classList.add(CLASS_NAME_OPEN)}_setElementAttributes(e,t,i){SelectorEngine.find(e).forEach((e=>{var o=e.style[t],n=window.getComputedStyle(e)[t];Manipulator.setDataAttribute(e,t,o),e.style[t]=i(Number.parseFloat(n))+"px"}))}_resetScrollbar(){this._resetElementAttributes(SELECTOR_FIXED_CONTENT,"paddingRight"),this._resetElementAttributes(SELECTOR_STICKY_CONTENT,"marginRight"),this._resetElementAttributes("body","paddingRight")}_resetElementAttributes(e,t){SelectorEngine.find(e).forEach((e=>{var i=Manipulator.getDataAttribute(e,t);void 0===i&&e===document.body?e.style[t]="":(Manipulator.removeDataAttribute(e,t),e.style[t]=i)}))}_getScrollbarWidth(){var e=document.createElement("div");e.className=CLASS_NAME_SCROLLBAR_MEASURER,document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t}static jQueryInterface(e,t){return this.each((function(){var i=Data.getData(this,DATA_KEY),o=_objectSpread2(_objectSpread2(_objectSpread2({},Default),Manipulator.getDataAttributes(this)),"object"==typeof e&&e?e:{});if(i||(i=new Modal(this,o)),"string"==typeof e){if(void 0===i[e])throw new TypeError('No method named "'.concat(e,'"'));i[e](t)}}))}}if(EventHandler.on(document,EVENT_CLICK_DATA_API,SELECTOR_DATA_TOGGLE,(function(e){var t=getElementFromSelector(this);"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault(),EventHandler.one(t,EVENT_SHOW,(e=>{e.defaultPrevented||EventHandler.one(t,EVENT_HIDDEN,(()=>{isVisible(this)&&this.focus()}))}));var i=Data.getData(t,DATA_KEY);if(!i){var o=_objectSpread2(_objectSpread2({},Manipulator.getDataAttributes(t)),Manipulator.getDataAttributes(this));i=new Modal(t,o)}i.toggle(this)})),defineJQueryPlugin(NAME,Modal),Joomla=Joomla||{},Joomla.Modal=Joomla.Modal||{},window.bootstrap=window.bootstrap||{},window.bootstrap.Modal=Modal,Joomla.initialiseModal=(e,t)=>{e instanceof Element&&(new window.bootstrap.Modal(e,t),e.open=()=>{window.bootstrap.Modal.getInstance(e).show(e)},e.close=()=>{window.bootstrap.Modal.getInstance(e).hide()},e.addEventListener("show.bs.modal",(()=>{if(Joomla.Modal.setCurrent(e),e.dataset.url){var t=e.querySelector(".modal-body"),i=t.querySelector("iframe");if(i){var o=e.querySelector("joomla-field-mediamore");o&&o.parentNode.removeChild(o),i.parentNode.removeChild(i)}if(e.dataset.iframe.indexOf("document.getElementById")>0){var n,s=e.dataset.iframe.split("+"),a=s[1].split('"');if(a[0]=a[0].replace(/&quot;/g,'"'),document.getElementById(a[1]))n=document.getElementById(a[1]).value;else n=new Function("return ".concat(a[0])).call(null);t.insertAdjacentHTML("afterbegin","".concat(s[0]).concat(n).concat(s[2]))}else t.insertAdjacentHTML("afterbegin",e.dataset.iframe)}})),e.addEventListener("shown.bs.modal",(()=>{var t=e.querySelector(".modal-body"),i=e.querySelector(".modal-header"),o=e.querySelector(".modal-footer"),n=0,s=0,a=0,r=0,l=0;if(t){if(i)n=i.getBoundingClientRect().height,l=t.offsetHeight;o&&(s=parseFloat(getComputedStyle(o,null).height.replace("px","")));var d=parseFloat(getComputedStyle(t,null).height.replace("px","")),_=t.offsetTop;a=parseFloat(getComputedStyle(document.body,null).height.replace("px",""))-2*_-(n+s+(r=l-d))}if(e.dataset.url){var E=e.querySelector("iframe");parseFloat(getComputedStyle(E,null).height.replace("px",""))>a&&(t.style.maxHeight=a,t.style.overflowY="auto",E.style.maxHeight=a-r)}})),e.addEventListener("hide.bs.modal",(()=>{e.querySelector(".modal-body").style.maxHeight="initial"})),e.addEventListener("hidden.bs.modal",(()=>{Joomla.Modal.setCurrent("")})))},Joomla.iframeButtonClick=e=>{if(!e.iframeSelector||!e.buttonSelector)throw new Error("Selector is missing");var t=document.querySelector("".concat(e.iframeSelector," iframe"));if(t){var i=t.contentWindow.document.querySelector(e.buttonSelector);i&&i.click()}},Joomla&&Joomla.getOptions){var modals=Joomla.getOptions("bootstrap.modal");"object"==typeof modals&&null!==modals&&Object.keys(modals).forEach((e=>{var t=modals[e],i={backdrop:!t.backdrop||t.backdrop,keyboard:!t.keyboard||t.keyboard,focus:!t.focus||t.focus};Array.from(document.querySelectorAll(e)).map((e=>Joomla.initialiseModal(e,i)))}))}export{Modal as M};